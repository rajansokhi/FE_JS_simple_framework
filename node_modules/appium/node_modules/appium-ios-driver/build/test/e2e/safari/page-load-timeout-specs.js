'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _setupBase = require("../setup-base");

var _setupBase2 = _interopRequireDefault(_setupBase);

var _helpersEnv = require('../helpers/env');

var _helpersEnv2 = _interopRequireDefault(_helpersEnv);

var _helpersSession = require('../helpers/session');

// TODO: fix page load handling in appium-remote-debugger
// right now it is not respected, so we need to skip
describe.skip('safari - page load timeout', function () {
  this.timeout(_helpersSession.MOCHA_SAFARI_TIMEOUT);

  var driver = (0, _setupBase2['default'])(this, { browserName: 'safari' }).driver;

  describe('small timeout, slow page load', function () {
    var _this = this;

    it('should not go to the requested page', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.timeouts('page load', 5000));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.setUrl(_helpersEnv2['default'].GUINEA_TEST_END_POINT + '?delay=30000'));

          case 4:
            context$3$0.next = 6;
            return _regeneratorRuntime.awrap(driver.getPageSource());

          case 6:
            context$3$0.sent.should.include('Let\'s browse!');

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });

  describe('no timeout, very slow page', function () {
    var _this2 = this;

    var startMs = Date.now();

    it('should go to the requested page', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.timeouts('command', 120000));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.timeouts('page load', 0));

          case 4:
            context$3$0.next = 6;
            return _regeneratorRuntime.awrap(driver.setUrl(_helpersEnv2['default'].GUINEA_TEST_END_POINT + '?delay=5000'));

          case 6:
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.getPageSource());

          case 8:
            context$3$0.sent.should.include('I am some page content');

            (Date.now() - startMs).should.be.above(5000);

          case 10:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });
  });
});

// the page should not have time to load

// the page should load after 70000
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3NhZmFyaS9wYWdlLWxvYWQtdGltZW91dC1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7eUJBQWtCLGVBQWU7Ozs7MEJBQ2pCLGdCQUFnQjs7Ozs4QkFDSyxvQkFBb0I7Ozs7QUFLekQsUUFBUSxDQUFDLElBQUksQ0FBQyw0QkFBNEIsRUFBRSxZQUFZO0FBQ3RELE1BQUksQ0FBQyxPQUFPLHNDQUFzQixDQUFDOztBQUVuQyxNQUFNLE1BQU0sR0FBRyw0QkFBTSxJQUFJLEVBQUUsRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUM7O0FBRTdELFVBQVEsQ0FBQywrQkFBK0IsRUFBRSxZQUFZOzs7QUFDcEQsTUFBRSxDQUFDLHFDQUFxQyxFQUFFOzs7Ozs2Q0FDbEMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDOzs7OzZDQUNsQyxNQUFNLENBQUMsTUFBTSxDQUFDLHdCQUFJLHFCQUFxQixHQUFHLGNBQWMsQ0FBQzs7Ozs2Q0FHeEQsTUFBTSxDQUFDLGFBQWEsRUFBRTs7OzZCQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsZ0JBQWdCOzs7Ozs7O0tBQy9ELENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQzs7QUFFSCxVQUFRLENBQUMsNEJBQTRCLEVBQUUsWUFBWTs7O0FBQ2pELFFBQUksT0FBTyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQzs7QUFFekIsTUFBRSxDQUFDLGlDQUFpQyxFQUFFOzs7Ozs2Q0FDOUIsTUFBTSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDOzs7OzZDQUNsQyxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7Ozs7NkNBQy9CLE1BQU0sQ0FBQyxNQUFNLENBQUMsd0JBQUkscUJBQXFCLEdBQUcsYUFBYSxDQUFDOzs7OzZDQUd2RCxNQUFNLENBQUMsYUFBYSxFQUFFOzs7NkJBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyx3QkFBd0I7O0FBQ3RFLGFBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLE9BQU8sQ0FBQSxDQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDOzs7Ozs7O0tBQzlDLENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L2UyZS9zYWZhcmkvcGFnZS1sb2FkLXRpbWVvdXQtc3BlY3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc2V0dXAgZnJvbSBcIi4uL3NldHVwLWJhc2VcIjtcbmltcG9ydCBlbnYgZnJvbSAnLi4vaGVscGVycy9lbnYnO1xuaW1wb3J0IHsgTU9DSEFfU0FGQVJJX1RJTUVPVVQgfSBmcm9tICcuLi9oZWxwZXJzL3Nlc3Npb24nO1xuXG5cbi8vIFRPRE86IGZpeCBwYWdlIGxvYWQgaGFuZGxpbmcgaW4gYXBwaXVtLXJlbW90ZS1kZWJ1Z2dlclxuLy8gcmlnaHQgbm93IGl0IGlzIG5vdCByZXNwZWN0ZWQsIHNvIHdlIG5lZWQgdG8gc2tpcFxuZGVzY3JpYmUuc2tpcCgnc2FmYXJpIC0gcGFnZSBsb2FkIHRpbWVvdXQnLCBmdW5jdGlvbiAoKSB7XG4gIHRoaXMudGltZW91dChNT0NIQV9TQUZBUklfVElNRU9VVCk7XG5cbiAgY29uc3QgZHJpdmVyID0gc2V0dXAodGhpcywgeyBicm93c2VyTmFtZTogJ3NhZmFyaScgfSkuZHJpdmVyO1xuXG4gIGRlc2NyaWJlKCdzbWFsbCB0aW1lb3V0LCBzbG93IHBhZ2UgbG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIG5vdCBnbyB0byB0aGUgcmVxdWVzdGVkIHBhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIudGltZW91dHMoJ3BhZ2UgbG9hZCcsIDUwMDApO1xuICAgICAgYXdhaXQgZHJpdmVyLnNldFVybChlbnYuR1VJTkVBX1RFU1RfRU5EX1BPSU5UICsgJz9kZWxheT0zMDAwMCcpO1xuXG4gICAgICAvLyB0aGUgcGFnZSBzaG91bGQgbm90IGhhdmUgdGltZSB0byBsb2FkXG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFBhZ2VTb3VyY2UoKSkuc2hvdWxkLmluY2x1ZGUoJ0xldFxcJ3MgYnJvd3NlIScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnbm8gdGltZW91dCwgdmVyeSBzbG93IHBhZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHN0YXJ0TXMgPSBEYXRlLm5vdygpO1xuXG4gICAgaXQoJ3Nob3VsZCBnbyB0byB0aGUgcmVxdWVzdGVkIHBhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIudGltZW91dHMoJ2NvbW1hbmQnLCAxMjAwMDApO1xuICAgICAgYXdhaXQgZHJpdmVyLnRpbWVvdXRzKCdwYWdlIGxvYWQnLCAwKTtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRVcmwoZW52LkdVSU5FQV9URVNUX0VORF9QT0lOVCArICc/ZGVsYXk9NTAwMCcpO1xuXG4gICAgICAvLyB0aGUgcGFnZSBzaG91bGQgbG9hZCBhZnRlciA3MDAwMFxuICAgICAgKGF3YWl0IGRyaXZlci5nZXRQYWdlU291cmNlKCkpLnNob3VsZC5pbmNsdWRlKCdJIGFtIHNvbWUgcGFnZSBjb250ZW50Jyk7XG4gICAgICAoRGF0ZS5ub3coKSAtIHN0YXJ0TXMpLnNob3VsZC5iZS5hYm92ZSg1MDAwKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiLi4vLi4vLi4vLi4ifQ==
