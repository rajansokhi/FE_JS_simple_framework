'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _desired = require('./desired');

var _desired2 = _interopRequireDefault(_desired);

var _setupBase = require('../../setup-base');

var _setupBase2 = _interopRequireDefault(_setupBase);

var _helpersWebview = require('../../helpers/webview');

var _helpersEnv = require('../../helpers/env');

var _helpersEnv2 = _interopRequireDefault(_helpersEnv);

var _helpersSession = require('../../helpers/session');

var GET_ELEM_SYNC = 'return document.getElementsByTagName(\'h1\')[0].innerHTML;';
var GET_ELEM_ASYNC = 'arguments[arguments.length - 1](document.getElementsByTagName(\'h1\')[0].innerHTML);';

describe('safari - webview - frames', function () {
  this.timeout(_helpersSession.MOCHA_SAFARI_TIMEOUT);

  var driver = (0, _setupBase2['default'])(this, _desired2['default'], { noReset: true }, false, true).driver;

  describe('frames', function () {
    var _this = this;

    beforeEach(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap((0, _helpersWebview.loadWebView)(_desired2['default'], driver, _helpersEnv2['default'].TEST_END_POINT + 'frameset.html', 'Frameset guinea pig'));

          case 2:
            return context$3$0.abrupt('return', context$3$0.sent);

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch to frame by name', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('first'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.sent.should.be.equal('Frameset guinea pig');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 7:
            h1 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 10:
            context$3$0.sent.should.be.equal('Sub frame 1');

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch to frame by index', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame(1));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.sent.should.be.equal('Frameset guinea pig');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 7:
            h1 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 10:
            context$3$0.sent.should.be.equal('Sub frame 2');

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch to frame by id', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('frame3'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.sent.should.be.equal('Frameset guinea pig');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 7:
            h1 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 10:
            context$3$0.sent.should.be.equal('Sub frame 3');

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch back to default content from frame', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('first'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.sent.should.be.equal('Frameset guinea pig');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 7:
            h1 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 10:
            context$3$0.sent.should.be.equal('Sub frame 1');
            context$3$0.next = 13;
            return _regeneratorRuntime.awrap(driver.setFrame(null));

          case 13:
            context$3$0.next = 15;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'frameset'));

          case 15:
            context$3$0.sent.should.exist;

          case 16:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch to child frames', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('third'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.sent.should.be.equal('Frameset guinea pig');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.setFrame('childframe'));

          case 7:
            context$3$0.next = 9;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'only_on_page_2'));

          case 9:
            context$3$0.sent.should.exist;

          case 10:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should execute javascript in frame', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('first'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.execute(GET_ELEM_SYNC));

          case 4:
            context$3$0.sent.should.be.equal('Sub frame 1');

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should execute async javascript in frame', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('first'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.executeAsync(GET_ELEM_ASYNC));

          case 4:
            context$3$0.sent.should.be.equal('Sub frame 1');

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });

  describe('iframes', function () {
    var _this2 = this;

    beforeEach(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap((0, _helpersWebview.loadWebView)(_desired2['default'], driver, _helpersEnv2['default'].TEST_END_POINT + 'iframes.html', 'Iframe guinea pig'));

          case 2:
            return context$3$0.abrupt('return', context$3$0.sent);

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch to iframe by name', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('iframe1'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.sent.should.be.equal('Iframe guinea pig');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 7:
            h1 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 10:
            context$3$0.sent.should.be.equal('Sub frame 1');

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch to iframe by index', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame(1));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.sent.should.be.equal('Iframe guinea pig');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 7:
            h1 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 10:
            context$3$0.sent.should.be.equal('Sub frame 2');

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch to iframe by id', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('id-iframe3'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.sent.should.be.equal('Iframe guinea pig');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 7:
            h1 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 10:
            context$3$0.sent.should.be.equal('Sub frame 3');

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch to iframe by element', function callee$2$0() {
      var frame, h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'id-iframe3'));

          case 2:
            frame = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.setFrame(frame));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.title());

          case 7:
            context$3$0.sent.should.be.equal('Iframe guinea pig');
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 10:
            h1 = context$3$0.sent;
            context$3$0.next = 13;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 13:
            context$3$0.sent.should.be.equal('Sub frame 3');

          case 14:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should not switch to iframe by element of wrong type', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 2:
            h1 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.setFrame(h1).should.eventually.be.rejected);

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch back to default content from iframe', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('iframe1'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.sent.should.be.equal('Iframe guinea pig');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 7:
            h1 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 10:
            context$3$0.sent.should.be.equal('Sub frame 1');
            context$3$0.next = 13;
            return _regeneratorRuntime.awrap(driver.setFrame(null));

          case 13:
            context$3$0.next = 15;
            return _regeneratorRuntime.awrap(driver.findElements('tag name', 'iframe'));

          case 15:
            context$3$0.sent.should.have.length(3);

          case 16:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3NhZmFyaS93ZWJ2aWV3L2ZyYW1lcy1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7dUJBQW9CLFdBQVc7Ozs7eUJBQ2Isa0JBQWtCOzs7OzhCQUNSLHVCQUF1Qjs7MEJBQ25DLG1CQUFtQjs7Ozs4QkFDRSx1QkFBdUI7O0FBRzVELElBQU0sYUFBYSwrREFBNkQsQ0FBQztBQUNqRixJQUFNLGNBQWMseUZBQXVGLENBQUM7O0FBRTVHLFFBQVEsQ0FBQywyQkFBMkIsRUFBRSxZQUFZO0FBQ2hELE1BQUksQ0FBQyxPQUFPLHNDQUFzQixDQUFDOztBQUVuQyxNQUFNLE1BQU0sR0FBRyw0QkFBTSxJQUFJLHdCQUFXLEVBQUMsT0FBTyxFQUFFLElBQUksRUFBQyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUM7O0FBRXpFLFVBQVEsQ0FBQyxRQUFRLEVBQUUsWUFBWTs7O0FBQzdCLGNBQVUsQ0FBQzs7Ozs7NkNBQWtCLHVEQUUzQixNQUFNLEVBQ0gsd0JBQUksY0FBYyxvQkFDckIscUJBQXFCLENBQ3RCOzs7Ozs7Ozs7O0tBQUEsQ0FBQyxDQUFDOztBQUVILE1BQUUsQ0FBQyxnQ0FBZ0MsRUFBRTtVQUkvQixFQUFFOzs7Ozs2Q0FIQSxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQzs7Ozs2Q0FDdkIsTUFBTSxDQUFDLEtBQUssRUFBRTs7OzZCQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLHFCQUFxQjs7NkNBRTdDLE1BQU0sQ0FBQyxXQUFXLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQzs7O0FBQS9DLGNBQUU7OzZDQUNDLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDOzs7NkJBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsYUFBYTs7Ozs7OztLQUN6RCxDQUFDLENBQUM7O0FBRUgsTUFBRSxDQUFDLGlDQUFpQyxFQUFFO1VBSWhDLEVBQUU7Ozs7OzZDQUhBLE1B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Q0FBQyxLQUFLLENBQUMsYUFBYTs7NkNBRWxELE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDOzs7OzZDQUNwQixNQUFNLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRSxRQUFRLENBQUM7Ozs2QkFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDOzs7Ozs7O0tBQ3ZFLENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L2UyZS9zYWZhcmkvd2Vidmlldy9mcmFtZXMtc3BlY3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVzaXJlZCBmcm9tICcuL2Rlc2lyZWQnO1xuaW1wb3J0IHNldHVwIGZyb20gJy4uLy4uL3NldHVwLWJhc2UnO1xuaW1wb3J0IHsgbG9hZFdlYlZpZXcgfSBmcm9tICcuLi8uLi9oZWxwZXJzL3dlYnZpZXcnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9oZWxwZXJzL2Vudic7XG5pbXBvcnQgeyBNT0NIQV9TQUZBUklfVElNRU9VVCB9IGZyb20gJy4uLy4uL2hlbHBlcnMvc2Vzc2lvbic7XG5cblxuY29uc3QgR0VUX0VMRU1fU1lOQyA9IGByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2gxJylbMF0uaW5uZXJIVE1MO2A7XG5jb25zdCBHRVRfRUxFTV9BU1lOQyA9IGBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoMScpWzBdLmlubmVySFRNTCk7YDtcblxuZGVzY3JpYmUoJ3NhZmFyaSAtIHdlYnZpZXcgLSBmcmFtZXMnLCBmdW5jdGlvbiAoKSB7XG4gIHRoaXMudGltZW91dChNT0NIQV9TQUZBUklfVElNRU9VVCk7XG5cbiAgY29uc3QgZHJpdmVyID0gc2V0dXAodGhpcywgZGVzaXJlZCwge25vUmVzZXQ6IHRydWV9LCBmYWxzZSwgdHJ1ZSkuZHJpdmVyO1xuXG4gIGRlc2NyaWJlKCdmcmFtZXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiBhd2FpdCBsb2FkV2ViVmlldyhcbiAgICAgIGRlc2lyZWQsXG4gICAgICBkcml2ZXIsXG4gICAgICBgJHtlbnYuVEVTVF9FTkRfUE9JTlR9ZnJhbWVzZXQuaHRtbGAsXG4gICAgICAnRnJhbWVzZXQgZ3VpbmVhIHBpZydcbiAgICApKTtcblxuICAgIGl0KCdzaG91bGQgc3dpdGNoIHRvIGZyYW1lIGJ5IG5hbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2ZpcnN0Jyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbCgnRnJhbWVzZXQgZ3VpbmVhIHBpZycpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoJ1N1YiBmcmFtZSAxJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCB0byBmcmFtZSBieSBpbmRleCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgxKTtcbiAgICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKCdGcmFtZXNldCBndWluZWEgcGlnJyk7XG5cbiAgICAgIGxldCBoMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgndGFnIG5hbWUnLCAnaDEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbCgnU3ViIGZyYW1lIDInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3dpdGNoIHRvIGZyYW1lIGJ5IGlkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZHJpdmVyLnNldEZyYW1lKCdmcmFtZTMnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKCdGcmFtZXNldCBndWluZWEgcGlnJyk7XG5cbiAgICAgIGxldCBoMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgndGFnIG5hbWUnLCAnaDEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbCgnU3ViIGZyYW1lIDMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3dpdGNoIGJhY2sgdG8gZGVmYXVsdCBjb250ZW50IGZyb20gZnJhbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2ZpcnN0Jyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbCgnRnJhbWVzZXQgZ3VpbmVhIHBpZycpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoJ1N1YiBmcmFtZSAxJyk7XG5cbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZShudWxsKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2ZyYW1lc2V0JykpLnNob3VsZC5leGlzdDtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3dpdGNoIHRvIGNoaWxkIGZyYW1lcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgndGhpcmQnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKCdGcmFtZXNldCBndWluZWEgcGlnJyk7XG5cbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnY2hpbGRmcmFtZScpO1xuICAgICAgKGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnb25seV9vbl9wYWdlXzInKSkuc2hvdWxkLmV4aXN0O1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleGVjdXRlIGphdmFzY3JpcHQgaW4gZnJhbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2ZpcnN0Jyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmV4ZWN1dGUoR0VUX0VMRU1fU1lOQykpLnNob3VsZC5iZS5lcXVhbCgnU3ViIGZyYW1lIDEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBhc3luYyBqYXZhc2NyaXB0IGluIGZyYW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZHJpdmVyLnNldEZyYW1lKCdmaXJzdCcpO1xuICAgICAgKGF3YWl0IGRyaXZlci5leGVjdXRlQXN5bmMoR0VUX0VMRU1fQVNZTkMpKS5zaG91bGQuYmUuZXF1YWwoJ1N1YiBmcmFtZSAxJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpZnJhbWVzJywgZnVuY3Rpb24gKCkge1xuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4gYXdhaXQgbG9hZFdlYlZpZXcoXG4gICAgICBkZXNpcmVkLFxuICAgICAgZHJpdmVyLFxuICAgICAgYCR7ZW52LlRFU1RfRU5EX1BPSU5UfWlmcmFtZXMuaHRtbGAsXG4gICAgICAnSWZyYW1lIGd1aW5lYSBwaWcnXG4gICAgKSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCB0byBpZnJhbWUgYnkgbmFtZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnaWZyYW1lMScpO1xuICAgICAgKGF3YWl0IGRyaXZlci50aXRsZSgpKS5zaG91bGQuYmUuZXF1YWwoJ0lmcmFtZSBndWluZWEgcGlnJyk7XG5cbiAgICAgIGxldCBoMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgndGFnIG5hbWUnLCAnaDEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbCgnU3ViIGZyYW1lIDEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3dpdGNoIHRvIGlmcmFtZSBieSBpbmRleCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgxKTtcbiAgICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKCdJZnJhbWUgZ3VpbmVhIHBpZycpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoJ1N1YiBmcmFtZSAyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCB0byBpZnJhbWUgYnkgaWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2lkLWlmcmFtZTMnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKCdJZnJhbWUgZ3VpbmVhIHBpZycpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoJ1N1YiBmcmFtZSAzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCB0byBpZnJhbWUgYnkgZWxlbWVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBmcmFtZSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnaWQtaWZyYW1lMycpO1xuICAgICAgYXdhaXQgZHJpdmVyLnNldEZyYW1lKGZyYW1lKTtcbiAgICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKCdJZnJhbWUgZ3VpbmVhIHBpZycpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoJ1N1YiBmcmFtZSAzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBzd2l0Y2ggdG8gaWZyYW1lIGJ5IGVsZW1lbnQgb2Ygd3JvbmcgdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBoMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgndGFnIG5hbWUnLCAnaDEnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZShoMSkuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWQ7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCBiYWNrIHRvIGRlZmF1bHQgY29udGVudCBmcm9tIGlmcmFtZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnaWZyYW1lMScpO1xuICAgICAgKGF3YWl0IGRyaXZlci50aXRsZSgpKS5zaG91bGQuYmUuZXF1YWwoJ0lmcmFtZSBndWluZWEgcGlnJyk7XG5cbiAgICAgIGxldCBoMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgndGFnIG5hbWUnLCAnaDEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbCgnU3ViIGZyYW1lIDEnKTtcblxuICAgICAgYXdhaXQgZHJpdmVyLnNldEZyYW1lKG51bGwpO1xuICAgICAgKGF3YWl0IGRyaXZlci5maW5kRWxlbWVudHMoJ3RhZyBuYW1lJywgJ2lmcmFtZScpKS5zaG91bGQuaGF2ZS5sZW5ndGgoMyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uLy4uLy4uIn0=
