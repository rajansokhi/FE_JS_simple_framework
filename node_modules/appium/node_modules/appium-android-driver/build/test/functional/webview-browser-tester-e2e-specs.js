'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _ = require('../..');

var _2 = _interopRequireDefault(_);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _asyncbox = require('asyncbox');

_chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

var AVD_ANDROID_24_WITHOUT_GMS = "Nexus_5_API_24";
var capabilities = {
  "browserName": "chromium-webview",
  "avd": AVD_ANDROID_24_WITHOUT_GMS,
  "platformName": "Android",
  "platformVersion": "7.0",
  "deviceName": "Android Emulator",
  "chromedriverExecutable": _path2['default'].join(process.cwd(), "chromedriver")
};

describe('Android 7 Webview Browser tester', function () {
  var _this = this;

  var driver = undefined;
  before(function () {
    if (process.env.REAL_DEVICE) {
      return this.skip();
    }
  });
  beforeEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          driver = new _2['default']();
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(driver.createSession(capabilities));

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  afterEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          if (!driver) {
            context$2$0.next = 3;
            break;
          }

          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(driver.deleteSession());

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should start android session using webview browser tester', function callee$1$0() {
    var contexts, el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.setUrl("http://google.com"));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap((0, _asyncbox.sleep)(1500));

        case 4:
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(driver.getContexts());

        case 6:
          contexts = context$2$0.sent;

          contexts.indexOf("CHROMIUM").should.not.equal(-1);
          context$2$0.next = 10;
          return _regeneratorRuntime.awrap(driver.setContext("CHROMIUM"));

        case 10:
          context$2$0.next = 12;
          return _regeneratorRuntime.awrap(driver.findElOrEls("id", "lst-ib", false));

        case 12:
          el = context$2$0.sent;

          el.should.not.equal(null);
          context$2$0.next = 16;
          return _regeneratorRuntime.awrap(driver.click(el.ELEMENT));

        case 16:
          context$2$0.next = 18;
          return _regeneratorRuntime.awrap((0, _asyncbox.sleep)(500));

        case 18:
          context$2$0.next = 20;
          return _regeneratorRuntime.awrap(driver.setElementValue("android", el.ELEMENT));

        case 20:
          context$2$0.next = 22;
          return _regeneratorRuntime.awrap((0, _asyncbox.sleep)(1500));

        case 22:
          context$2$0.next = 24;
          return _regeneratorRuntime.awrap(driver.findElOrEls("id", "tsbb", false));

        case 24:
          el = context$2$0.sent;

          el.should.not.equal(null);
          context$2$0.next = 28;
          return _regeneratorRuntime.awrap(driver.click(el.ELEMENT));

        case 28:
          context$2$0.next = 30;
          return _regeneratorRuntime.awrap((0, _asyncbox.sleep)(5000));

        case 30:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZnVuY3Rpb25hbC93ZWJ2aWV3LWJyb3dzZXItdGVzdGVyLWUyZS1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7b0JBQWlCLE1BQU07Ozs7OEJBQ0ksa0JBQWtCOzs7O2dCQUNuQixPQUFPOzs7O29CQUNoQixNQUFNOzs7O3dCQUNELFVBQVU7O0FBRWhDLGtCQUFLLE1BQU0sRUFBRSxDQUFDO0FBQ2Qsa0JBQUssR0FBRyw2QkFBZ0IsQ0FBQzs7QUFFekIsSUFBTSwwQkFBMEIsR0FBRyxnQkFBZ0IsQ0FBQztBQUNwRCxJQUFNLFlBQVksR0FBRztBQUNuQixlQUFhLEVBQUUsa0JBQWtCO0FBQ2pDLE9BQUssRUFBRSwwQkFBMEI7QUFDakMsZ0JBQWMsRUFBRSxTQUFTO0FBQ3pCLG1CQUFpQixFQUFFLEtBQUs7QUFDeEIsY0FBWSxFQUFFLGtCQUFrQjtBQUNoQywwQkFBd0IsRUFBRSxrQkFBSyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxFQUFFLGNBQWMsQ0FBQztDQUNuRSxDQUFDOztBQUVGLFFBQVEsQ0FBQyxrQ0FBa0MsRUFBRSxZQUFZOzs7QUFDdkQsTUFBSSxNQUFNLFlBQUEsQ0FBQztBQUNYLFFBQU0sQ0FBQyxZQUFZO0FBQ2pCLFFBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUU7QUFDM0IsYUFBTyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7S0FDcEI7R0FDRixDQUFDLENBQUM7QUFDSCxZQUFVLENBQUM7Ozs7QUFDVCxnQkFBTSxHQUFHLG1CQUFtQixDQUFDOzsyQ0FDdkIsTUFBTSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUM7Ozs7Ozs7R0FDekMsQ0FBQyxDQUFDO0FBQ0gsV0FBUyxDQUFDOzs7O2VBQ0osTUFBTTs7Ozs7OzJDQUNGLE1BQU0sQ0FBQyxhQUFhLEVBQUU7Ozs7Ozs7R0FFL0IsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLDJEQUEyRCxFQUFFO1FBRzFELFFBQVEsRUFHUixFQUFFOzs7OzsyQ0FMQSxNQUFNLENBQUMsTUFBTSxDQUFDLG1CQUFtQixDQUFDOzs7OzJDQUNsQyxxQkFBTSxJQUFJLENBQUM7Ozs7MkNBQ0ksTUFBTSxDQUFDLFdBQVcsRUFBRTs7O0FBQXJDLGtCQUFROztBQUNaLGtCQUFRLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7OzJDQUM1QyxNQUFNLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQzs7OzsyQ0FDcEIsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLEtBQUssQ0FBQzs7O0FBQXBELFlBQUU7O0FBQ04sWUFBRSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDOzsyQ0FDcEIsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDOzs7OzJDQUN4QixxQkFBTSxHQUFHLENBQUM7Ozs7MkNBQ1YsTUFBTSxDQUFDLGVBQWUsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQzs7OzsyQ0FDN0MscUJBQU0sSUFBSSxDQUFDOzs7OzJDQUNOLE1BQU0sQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUM7OztBQUFsRCxZQUFFOztBQUNGLFlBQUUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQzs7MkNBQ3BCLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQzs7OzsyQ0FDeEIscUJBQU0sSUFBSSxDQUFDOzs7Ozs7O0dBQ2xCLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L2Z1bmN0aW9uYWwvd2Vidmlldy1icm93c2VyLXRlc3Rlci1lMmUtc3BlY3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcbmltcG9ydCBjaGFpQXNQcm9taXNlZCBmcm9tICdjaGFpLWFzLXByb21pc2VkJztcbmltcG9ydCBBbmRyb2lkRHJpdmVyIGZyb20gJy4uLy4uJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgc2xlZXAgfSBmcm9tICdhc3luY2JveCc7XG5cbmNoYWkuc2hvdWxkKCk7XG5jaGFpLnVzZShjaGFpQXNQcm9taXNlZCk7XG5cbmNvbnN0IEFWRF9BTkRST0lEXzI0X1dJVEhPVVRfR01TID0gXCJOZXh1c181X0FQSV8yNFwiO1xuY29uc3QgY2FwYWJpbGl0aWVzID0ge1xuICBcImJyb3dzZXJOYW1lXCI6IFwiY2hyb21pdW0td2Vidmlld1wiLFxuICBcImF2ZFwiOiBBVkRfQU5EUk9JRF8yNF9XSVRIT1VUX0dNUyxcbiAgXCJwbGF0Zm9ybU5hbWVcIjogXCJBbmRyb2lkXCIsXG4gIFwicGxhdGZvcm1WZXJzaW9uXCI6IFwiNy4wXCIsXG4gIFwiZGV2aWNlTmFtZVwiOiBcIkFuZHJvaWQgRW11bGF0b3JcIixcbiAgXCJjaHJvbWVkcml2ZXJFeGVjdXRhYmxlXCI6IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBcImNocm9tZWRyaXZlclwiKVxufTtcblxuZGVzY3JpYmUoJ0FuZHJvaWQgNyBXZWJ2aWV3IEJyb3dzZXIgdGVzdGVyJywgZnVuY3Rpb24gKCkge1xuICBsZXQgZHJpdmVyO1xuICBiZWZvcmUoZnVuY3Rpb24gKCkge1xuICAgIGlmIChwcm9jZXNzLmVudi5SRUFMX0RFVklDRSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2tpcCgpO1xuICAgIH1cbiAgfSk7XG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIGRyaXZlciA9IG5ldyBBbmRyb2lkRHJpdmVyKCk7XG4gICAgYXdhaXQgZHJpdmVyLmNyZWF0ZVNlc3Npb24oY2FwYWJpbGl0aWVzKTtcbiAgfSk7XG4gIGFmdGVyRWFjaChhc3luYyAoKSA9PiB7XG4gICAgaWYgKGRyaXZlcikge1xuICAgICAgYXdhaXQgZHJpdmVyLmRlbGV0ZVNlc3Npb24oKTtcbiAgICB9XG4gIH0pO1xuICBpdCgnc2hvdWxkIHN0YXJ0IGFuZHJvaWQgc2Vzc2lvbiB1c2luZyB3ZWJ2aWV3IGJyb3dzZXIgdGVzdGVyJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGRyaXZlci5zZXRVcmwoXCJodHRwOi8vZ29vZ2xlLmNvbVwiKTtcbiAgICBhd2FpdCBzbGVlcCgxNTAwKTtcbiAgICBsZXQgY29udGV4dHMgPSBhd2FpdCBkcml2ZXIuZ2V0Q29udGV4dHMoKTtcbiAgICBjb250ZXh0cy5pbmRleE9mKFwiQ0hST01JVU1cIikuc2hvdWxkLm5vdC5lcXVhbCgtMSk7XG4gICAgYXdhaXQgZHJpdmVyLnNldENvbnRleHQoXCJDSFJPTUlVTVwiKTtcbiAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoXCJpZFwiLCBcImxzdC1pYlwiLCBmYWxzZSk7XG4gICAgZWwuc2hvdWxkLm5vdC5lcXVhbChudWxsKTtcbiAgICBhd2FpdCBkcml2ZXIuY2xpY2soZWwuRUxFTUVOVCk7XG4gICAgYXdhaXQgc2xlZXAoNTAwKTtcbiAgICBhd2FpdCBkcml2ZXIuc2V0RWxlbWVudFZhbHVlKFwiYW5kcm9pZFwiLCBlbC5FTEVNRU5UKTtcbiAgICBhd2FpdCBzbGVlcCgxNTAwKTtcbiAgICBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxPckVscyhcImlkXCIsIFwidHNiYlwiLCBmYWxzZSk7XG4gICAgZWwuc2hvdWxkLm5vdC5lcXVhbChudWxsKTtcbiAgICBhd2FpdCBkcml2ZXIuY2xpY2soZWwuRUxFTUVOVCk7XG4gICAgYXdhaXQgc2xlZXAoNTAwMCk7XG4gIH0pO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
