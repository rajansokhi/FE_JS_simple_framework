'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _appiumBaseDriver = require('appium-base-driver');

var _utils = require('../utils');

var _appiumSupport = require('appium-support');

var commands = {};

commands.getAttribute = function callee$0$0(attribute, el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'getAttribute',
          args: ['' + el, '' + attribute]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from getAttribute");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_STALE_ELEMENT)) {
          context$1$0.next = 16;
          break;
        }

        throw new _appiumBaseDriver.errors.StaleElementReferenceError();

      case 16:
        return context$1$0.abrupt('return', result.value);

      case 17:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.setValue = function callee$0$0(value, el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = (0, _utils.unwrapEl)(el);

        if (value instanceof Array) {
          value = value.join("");
        }
        if (typeof value !== 'string') {
          value = '' + value;
        }
        value = _appiumSupport.util.escapeSpecialChars(value, "'");
        // de-escape \n so it can be used specially
        value = value.replace(/\\\\n/g, "\\n");

        commandObject = {
          name: 'sendkeys',
          args: ['' + el, '' + value]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 9;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 9:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 11;

        result = JSON.parse(data);
        context$1$0.next = 18;
        break;

      case 15:
        context$1$0.prev = 15;
        context$1$0.t0 = context$1$0['catch'](11);
        throw new Error("Bad response from setValue");

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_STALE_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.StaleElementReferenceError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[11, 15]]);
};

commands.getText = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'getText',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from getText");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_STALE_ELEMENT)) {
          context$1$0.next = 16;
          break;
        }

        throw new _appiumBaseDriver.errors.StaleElementReferenceError();

      case 16:
        return context$1$0.abrupt('return', result.value);

      case 17:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.elementEnabled = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementEnabled',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from elementEnabled");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.elementSelected = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementSelected',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from elementSelected");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_ELEMENT_IS_NOT_SELECTABLE)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.ElementIsNotSelectableError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.elementDisplayed = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementDisplayed',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from elementDisplayed");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.clear = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'clear',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from clear");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.getLocation = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementLocation',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from elementLocation");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.getLocationInView = function callee$0$0(elementId) {
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        context$1$0.next = 2;
        return _regeneratorRuntime.awrap(this.getLocation(elementId));

      case 2:
        return context$1$0.abrupt('return', context$1$0.sent);

      case 3:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.getSize = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementSize',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from getSize");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

exports['default'] = commands;
module.exports = exports['default'];

// get status returned

// get status returned

// get status returned

// get status returned and handle errors returned from server

// get status returned and handle errors returned from server

// get status returned and handle errors returned from server

// get status returned and handle errors returned from server

// get status returned and handle errors returned from server
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9lbGVtZW50LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O2dDQUF1QixvQkFBb0I7O3FCQUNZLFVBQVU7OzZCQUM1QyxnQkFBZ0I7O0FBRXJDLElBQUksUUFBUSxHQUFHLEVBQUUsQ0FBQzs7QUFFbEIsUUFBUSxDQUFDLFlBQVksR0FBRyxvQkFBZ0IsU0FBUyxFQUFFLEVBQUU7TUFHL0MsYUFBYSxFQUliLFdBQVcsRUFFWCxJQUFJLEVBRUosTUFBTTs7OztBQVZWLFVBQUUsR0FBRyxxQkFBUyxFQUFFLENBQUMsQ0FBQzs7QUFFZCxxQkFBYSxHQUFHO0FBQ2xCLGNBQUksRUFBRSxjQUFjO0FBQ3BCLGNBQUksRUFBRSxNQUFJLEVBQUUsT0FBTyxTQUFTLENBQUc7U0FDaEM7QUFDRyxtQkFBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDOzt5Q0FFOUIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQzs7O0FBQW5ELFlBQUk7QUFFSixjQUFNOzs7QUFFUixjQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQzs7Ozs7OztjQUVwQixJQUFJLEtBQUssQ0FBQyxnQ0FBZ0MsQ0FBQzs7O2NBSS9DLE1BQU0sQ0FBQyxNQUFNLEtBQUssb0NBQTZCLHVCQUF1QixDQUFBOzs7OztjQUNsRSxJQUFJLHlCQUFPLDBCQUEwQixFQUFFOzs7NENBRXhDLE1BQU0sQ0FBQyxLQUFLOzs7Ozs7O0NBQ3BCLENBQUM7O0FBRUYsUUFBUSxDQUFDLFFBQVEsR0FBRyxvQkFBZ0IsS0FBSyxFQUFFLEVBQUU7TUFhdkMsYUFBYSxFQUliLFdBQVcsRUFFWCxJQUFJLEVBRUosTUFBTTs7OztBQXBCVixVQUFFLEdBQUcscUJBQVMsRUFBRSxDQUFDLENBQUM7O0FBRWxCLFlBQUksS0FBSyxZQUFZLEtBQUssRUFBRTtBQUMxQixlQUFLLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUN4QjtBQUNELFlBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFO0FBQzdCLGVBQUssUUFBTSxLQUFLLEFBQUUsQ0FBQztTQUNwQjtBQUNELGFBQUssR0FBRyxvQkFBSyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUM7O0FBRTVDLGFBQUssR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQzs7QUFFbkMscUJBQWEsR0FBRztBQUNsQixjQUFJLEVBQUUsVUFBVTtBQUNoQixjQUFJLEVBQUUsTUFBSSxFQUFFLE9BQU8sS0FBSyxDQUFHO1NBQzVCO0FBQ0csbUJBQVcsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQzs7eUNBRTlCLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLENBQUM7OztBQUFuRCxZQUFJO0FBRUosY0FBTTs7O0FBRVIsY0FBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7Ozs7Ozs7Y0FFcEIsSUFBSSxLQUFLLENBQUMsNEJBQTRCLENBQUM7OztjQUkzQyxNQUFNLENBQUMsTUFBTSxLQUFLLG9DQUE2Qix1QkFBdUIsQ0FBQTs7Ozs7Y0FDbEUsSUFBSSx5QkFBTywwQkFBMEIsRUFBRTs7OzRDQUV4QyxNQUFNLENBQUMsS0FBSzs7Ozs7OztDQUVwQixDQUFDOztBQUVGLFFBQVEsQ0FBQyxPQUFPLEdBQUcsb0JBQWdCLEVBQUU7TUFHL0IsYUFBYSxFQUliLFdBQVcsRUFFWCxJQUFJLEVBRUosTUFBTTs7OztBQVZWLFVBQUUsR0FBRyxxQkFBUyxFQUFFLENBQUMsQ0FBQzs7QUFFZCxxQkFBYSxHQUFHO0FBQ2xCLGNBQUksRUFBRSxTQUFTO0FBQ2YsY0FBSSxFQUFFLE1BQUksRUFBRSxDQUFHO1NBQ2hCO0FBQ0csbUJBQVcsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQzs7eUNBRTlCLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLENBQUM7OztBQUFuRCxZQUFJO0FBRUosY0FBTTs7O0FBRVIsY0FBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7Ozs7Ozs7Y0FFcEIsSUFBSSxLQUFLLENBQUMsMkJBQTJCLENBQUM7OztjQUkxQyxNQUFNLENBQUMsTUFBTSxLQUFLLG9DQUE2Qix1QkFBdUIsQ0FBQTs7Ozs7Y0FDbEUsSUFBSSx5QkFBTywwQkFBMEIsRUFBRTs7OzRDQUV4QyxNQUFNLENBQUMsS0FBSzs7Ozs7OztDQUVwQixDQUFDOztBQUVGLFFBQVEsQ0FBQyxjQUFjLEdBQUcsb0JBQWdCLEVBQUU7TUFJdEMsYUFBYSxFQUliLFdBQVcsRUFFWCxJQUFJLEVBRUosTUFBTTs7Ozs7QUFWVixVQUFFLEdBQUcscUJBQVMsRUFBRSxDQUFDLENBQUM7O0FBRWQscUJBQWEsR0FBRztBQUNsQixjQUFJLEVBQUUsZ0JBQWdCO0FBQ3RCLGNBQUksRUFBRSxNQUFJLEVBQUUsQ0FBRztTQUNoQjtBQUNHLG1CQUFXLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUM7O3lDQUU5QixJQUFJLENBQUMsb0JBQW9CLENBQUMsV0FBVyxDQUFDOzs7QUFBbkQsWUFBSTtBQUVKLGNBQU07OztBQUVSLGNBQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDOzs7Ozs7O2NBRXBCLElBQUksS0FBSyxDQUFDLGtDQUFrQyxDQUFDOzs7Y0FJakQsTUFBTSxDQUFDLE1BQU0sS0FBSyxvQ0FBNkIseUJBQXlCLENBQUE7Ozs7O2NBQ3BFLElBQUkseUJBQU8sbUJBQW1CLEVBQUU7OztjQUM3QixNQUFNLENBQUMsTUFBTSxLQUFLLG9DQUE2Qix5QkFBeUIsQ0FBQTs7Ozs7Y0FDM0UsSUFBSSx5QkFBTyxrQkFBa0IsRUFBRTs7OzRDQUdoQyxNQUFNLENBQUMsS0FBSzs7Ozs7OztDQUNwQixDQUFDOztBQUVGLFFBQVEsQ0FBQyxlQUFlLEdBQUcsb0JBQWdCLEVBQUU7TUFJdkMsYUFBYSxFQUliLFdBQVcsRUFFWCxJQUFJLEVBRUosTUFBTTs7Ozs7QUFWVixVQUFFLEdBQUcscUJBQVMsRUFBRSxDQUFDLENBQUM7O0FBRWQscUJBQWEsR0FBRztBQUNsQixjQUFJLEVBQUUsaUJBQWlCO0FBQ3ZCLGNBQUksRUFBRSxNQUFJLEVBQUUsQ0FBRztTQUNoQjtBQUNHLG1CQUFXLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUM7O3lDQUU5QixJQUFJLENBQUMsb0JBQW9CLENBQUMsV0FBVyxDQUFDOzs7QUFBbkQsWUFBSTtBQUVKLGNBQU07OztBQUVSLGNBQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDOzs7Ozs7O2NBRXBCLElBQUksS0FBSyxDQUFDLG1DQUFtQyxDQUFDOzs7Y0FJbEQsTUFBTSxDQUFDLE1BQU0sS0FBSyxvQ0FBNkIsbUNBQW1DLENBQUE7Ozs7O2NBQzlFLElBQUkseUJBQU8sMkJBQTJCLEVBQUU7OztjQUNyQyxNQUFNLENBQUMsTUFBTSxLQUFLLG9DQUE2Qix5QkFBeUIsQ0FBQTs7Ozs7Y0FDM0UsSUFBSSx5QkFBTyxrQkFBa0IsRUFBRTs7OzRDQUdoQyxNQUFNLENBQUMsS0FBSzs7Ozs7OztDQUNwQixDQUFDOztBQUVGLFFBQVEsQ0FBQyxnQkFBZ0IsR0FBRyxvQkFBZ0IsRUFBRTtNQUl4QyxhQUFhLEVBSWIsV0FBVyxFQUVYLElBQUksRUFFSixNQUFNOzs7OztBQVZWLFVBQUUsR0FBRyxxQkFBUyxFQUFFLENBQUMsQ0FBQzs7QUFFZCxxQkFBYSxHQUFHO0FBQ2xCLGNBQUksRUFBRSxrQkFBa0I7QUFDeEIsY0FBSSxFQUFFLE1BQUksRUFBRSxDQUFHO1NBQ2hCO0FBQ0csbUJBQVcsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQzs7eUNBRTlCLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLENBQUM7OztBQUFuRCxZQUFJO0FBRUosY0FBTTs7O0FBRVIsY0FBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7Ozs7Ozs7Y0FFcEIsSUFBSSxLQUFLLENBQUMsb0NBQW9DLENBQUM7OztjQUluRCxNQUFNLENBQUMsTUFBTSxLQUFLLG9DQUE2Qix5QkFBeUIsQ0FBQTs7Ozs7Y0FDcEUsSUFBSSx5QkFBTyxtQkFBbUIsRUFBRTs7O2NBQzdCLE1BQU0sQ0FBQyxNQUFNLEtBQUssb0NBQTZCLHlCQUF5QixDQUFBOzs7OztjQUMzRSxJQUFJLHlCQUFPLGtCQUFrQixFQUFFOzs7NENBR2hDLE1BQU0sQ0FBQyxLQUFLOzs7Ozs7O0NBQ3BCLENBQUM7O0FBRUYsUUFBUSxDQUFDLEtBQUssR0FBRyxvQkFBZ0IsRUFBRTtNQUc3QixhQUFhLEVBS2IsV0FBVyxFQUVYLElBQUksRUFFSixNQUFNOzs7O0FBWFYsVUFBRSxHQUFHLHFCQUFTLEVBQUUsQ0FBQyxDQUFDOztBQUVkLHFCQUFhLEdBQUc7QUFDbEIsY0FBSSxFQUFFLE9BQU87QUFDYixjQUFJLEVBQUUsTUFBSSxFQUFFLENBQUc7U0FDaEI7QUFFRyxtQkFBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDOzt5Q0FFOUIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQzs7O0FBQW5ELFlBQUk7QUFFSixjQUFNOzs7QUFFUixjQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQzs7Ozs7OztjQUVwQixJQUFJLEtBQUssQ0FBQyx5QkFBeUIsQ0FBQzs7O2NBR3hDLE1BQU0sQ0FBQyxNQUFNLEtBQUssb0NBQTZCLHlCQUF5QixDQUFBOzs7OztjQUNwRSxJQUFJLHlCQUFPLGtCQUFrQixFQUFFOzs7Y0FDNUIsTUFBTSxDQUFDLE1BQU0sS0FBSyxvQ0FBNkIseUJBQXlCLENBQUE7Ozs7O2NBQzNFLElBQUkseUJBQU8sbUJBQW1CLEVBQUU7Ozs0Q0FHakMsTUFBTSxDQUFDLEtBQUs7Ozs7Ozs7Q0FDcEIsQ0FBQzs7QUFFRixRQUFRLENBQUMsV0FBVyxHQUFHLG9CQUFnQixFQUFFO01BSW5DLGFBQWEsRUFJYixXQUFXLEVBRVgsSUFBSSxFQUVKLE1BQU07Ozs7O0FBVlYsVUFBRSxHQUFHLHFCQUFTLEVBQUUsQ0FBQyxDQUFDOztBQUVkLHFCQUFhLEdBQUc7QUFDbEIsY0FBSSxFQUFFLGlCQUFpQjtBQUN2QixjQUFJLEVBQUUsTUFBSSxFQUFFLENBQUc7U0FDaEI7QUFDRyxtQkFBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDOzt5Q0FFOUIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQzs7O0FBQW5ELFlBQUk7QUFFSixjQUFNOzs7QUFFUixjQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQzs7Ozs7OztjQUVwQixJQUFJLEtBQUssQ0FBQyxtQ0FBbUMsQ0FBQzs7O2NBSWxELE1BQU0sQ0FBQyxNQUFNLEtBQUssb0NBQTZCLHlCQUF5QixDQUFBOzs7OztjQUNwRSxJQUFJLHlCQUFPLG1CQUFtQixFQUFFOzs7Y0FDN0IsTUFBTSxDQUFDLE1BQU0sS0FBSyxvQ0FBNkIseUJBQXlCLENBQUE7Ozs7O2NBQzNFLElBQUkseUJBQU8sa0JBQWtCLEVBQUU7Ozs0Q0FHaEMsTUFBTSxDQUFDLEtBQUs7Ozs7Ozs7Q0FDcEIsQ0FBQzs7QUFFRixRQUFRLENBQUMsaUJBQWlCLEdBQUcsb0JBQWdCLFNBQVM7Ozs7O3lDQUN2QyxJQUFJLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQzs7Ozs7Ozs7OztDQUN6QyxDQUFDOztBQUVGLFFBQVEsQ0FBQyxPQUFPLEdBQUcsb0JBQWdCLEVBQUU7TUFJL0IsYUFBYSxFQUliLFdBQVcsRUFFWCxJQUFJLEVBRUosTUFBTTs7Ozs7QUFWVixVQUFFLEdBQUcscUJBQVMsRUFBRSxDQUFDLENBQUM7O0FBRWQscUJBQWEsR0FBRztBQUNsQixjQUFJLEVBQUUsYUFBYTtBQUNuQixjQUFJLEVBQUUsTUFBSSxFQUFFLENBQUc7U0FDaEI7QUFDRyxtQkFBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDOzt5Q0FFOUIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQzs7O0FBQW5ELFlBQUk7QUFFSixjQUFNOzs7QUFFUixjQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQzs7Ozs7OztjQUVwQixJQUFJLEtBQUssQ0FBQywyQkFBMkIsQ0FBQzs7O2NBSTFDLE1BQU0sQ0FBQyxNQUFNLEtBQUssb0NBQTZCLHlCQUF5QixDQUFBOzs7OztjQUNwRSxJQUFJLHlCQUFPLG1CQUFtQixFQUFFOzs7Y0FDN0IsTUFBTSxDQUFDLE1BQU0sS0FBSyxvQ0FBNkIseUJBQXlCLENBQUE7Ozs7O2NBQzNFLElBQUkseUJBQU8sa0JBQWtCLEVBQUU7Ozs0Q0FHaEMsTUFBTSxDQUFDLEtBQUs7Ozs7Ozs7Q0FDcEIsQ0FBQzs7cUJBRWEsUUFBUSIsImZpbGUiOiJsaWIvY29tbWFuZHMvZWxlbWVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGVycm9ycyB9IGZyb20gJ2FwcGl1bS1iYXNlLWRyaXZlcic7XG5pbXBvcnQgeyB1bndyYXBFbCwgeW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcyB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCB7IHV0aWwgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5cbmxldCBjb21tYW5kcyA9IHt9O1xuXG5jb21tYW5kcy5nZXRBdHRyaWJ1dGUgPSBhc3luYyBmdW5jdGlvbiAoYXR0cmlidXRlLCBlbCkge1xuICBlbCA9IHVud3JhcEVsKGVsKTtcblxuICB2YXIgY29tbWFuZE9iamVjdCA9IHtcbiAgICBuYW1lOiAnZ2V0QXR0cmlidXRlJyxcbiAgICBhcmdzOiBbYCR7ZWx9YCwgYCR7YXR0cmlidXRlfWBdXG4gIH07XG4gIHZhciBjb21tYW5kSlNPTiA9IEpTT04uc3RyaW5naWZ5KGNvbW1hbmRPYmplY3QpO1xuXG4gIGxldCBkYXRhID0gYXdhaXQgdGhpcy5leGVjdXRlU29ja2V0Q29tbWFuZChjb21tYW5kSlNPTik7XG5cbiAgbGV0IHJlc3VsdDtcbiAgdHJ5IHtcbiAgICByZXN1bHQgPSBKU09OLnBhcnNlKGRhdGEpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQmFkIHJlc3BvbnNlIGZyb20gZ2V0QXR0cmlidXRlXCIpO1xuICB9XG5cbiAgLy8gZ2V0IHN0YXR1cyByZXR1cm5lZFxuICBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfU1RBTEVfRUxFTUVOVClcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlN0YWxlRWxlbWVudFJlZmVyZW5jZUVycm9yKCk7XG5cbiAgcmV0dXJuIHJlc3VsdC52YWx1ZTtcbn07XG5cbmNvbW1hbmRzLnNldFZhbHVlID0gYXN5bmMgZnVuY3Rpb24gKHZhbHVlLCBlbCkge1xuICBlbCA9IHVud3JhcEVsKGVsKTtcblxuICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgIHZhbHVlID0gdmFsdWUuam9pbihcIlwiKTtcbiAgfVxuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHZhbHVlID0gYCR7dmFsdWV9YDtcbiAgfVxuICB2YWx1ZSA9IHV0aWwuZXNjYXBlU3BlY2lhbENoYXJzKHZhbHVlLCBcIidcIik7XG4gIC8vIGRlLWVzY2FwZSBcXG4gc28gaXQgY2FuIGJlIHVzZWQgc3BlY2lhbGx5XG4gIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxcXFxcXFxuL2csIFwiXFxcXG5cIik7XG5cbiAgdmFyIGNvbW1hbmRPYmplY3QgPSB7XG4gICAgbmFtZTogJ3NlbmRrZXlzJyxcbiAgICBhcmdzOiBbYCR7ZWx9YCwgYCR7dmFsdWV9YF1cbiAgfTtcbiAgdmFyIGNvbW1hbmRKU09OID0gSlNPTi5zdHJpbmdpZnkoY29tbWFuZE9iamVjdCk7XG5cbiAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmV4ZWN1dGVTb2NrZXRDb21tYW5kKGNvbW1hbmRKU09OKTtcblxuICBsZXQgcmVzdWx0O1xuICB0cnkge1xuICAgIHJlc3VsdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJCYWQgcmVzcG9uc2UgZnJvbSBzZXRWYWx1ZVwiKTtcbiAgfVxuXG4gIC8vIGdldCBzdGF0dXMgcmV0dXJuZWRcbiAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX1NUQUxFX0VMRU1FTlQpXG4gICAgdGhyb3cgbmV3IGVycm9ycy5TdGFsZUVsZW1lbnRSZWZlcmVuY2VFcnJvcigpO1xuXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG5cbn07XG5cbmNvbW1hbmRzLmdldFRleHQgPSBhc3luYyBmdW5jdGlvbiAoZWwpIHtcbiAgZWwgPSB1bndyYXBFbChlbCk7XG5cbiAgdmFyIGNvbW1hbmRPYmplY3QgPSB7XG4gICAgbmFtZTogJ2dldFRleHQnLFxuICAgIGFyZ3M6IFtgJHtlbH1gXVxuICB9O1xuICB2YXIgY29tbWFuZEpTT04gPSBKU09OLnN0cmluZ2lmeShjb21tYW5kT2JqZWN0KTtcblxuICBsZXQgZGF0YSA9IGF3YWl0IHRoaXMuZXhlY3V0ZVNvY2tldENvbW1hbmQoY29tbWFuZEpTT04pO1xuXG4gIGxldCByZXN1bHQ7XG4gIHRyeSB7XG4gICAgcmVzdWx0ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkJhZCByZXNwb25zZSBmcm9tIGdldFRleHRcIik7XG4gIH1cblxuICAvLyBnZXQgc3RhdHVzIHJldHVybmVkXG4gIGlmIChyZXN1bHQuc3RhdHVzID09PSB5b3VpRW5naW5lRHJpdmVyUmV0dXJuVmFsdWVzLldFQkRSSVZFUl9TVEFMRV9FTEVNRU5UKVxuICAgIHRocm93IG5ldyBlcnJvcnMuU3RhbGVFbGVtZW50UmVmZXJlbmNlRXJyb3IoKTtcblxuICByZXR1cm4gcmVzdWx0LnZhbHVlO1xuXG59O1xuXG5jb21tYW5kcy5lbGVtZW50RW5hYmxlZCA9IGFzeW5jIGZ1bmN0aW9uIChlbCkge1xuXG4gIGVsID0gdW53cmFwRWwoZWwpO1xuXG4gIHZhciBjb21tYW5kT2JqZWN0ID0ge1xuICAgIG5hbWU6ICdlbGVtZW50RW5hYmxlZCcsXG4gICAgYXJnczogW2Ake2VsfWBdXG4gIH07XG4gIHZhciBjb21tYW5kSlNPTiA9IEpTT04uc3RyaW5naWZ5KGNvbW1hbmRPYmplY3QpO1xuXG4gIGxldCBkYXRhID0gYXdhaXQgdGhpcy5leGVjdXRlU29ja2V0Q29tbWFuZChjb21tYW5kSlNPTik7XG5cbiAgbGV0IHJlc3VsdDtcbiAgdHJ5IHtcbiAgICByZXN1bHQgPSBKU09OLnBhcnNlKGRhdGEpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQmFkIHJlc3BvbnNlIGZyb20gZWxlbWVudEVuYWJsZWRcIik7XG4gIH1cblxuICAvLyBnZXQgc3RhdHVzIHJldHVybmVkIGFuZCBoYW5kbGUgZXJyb3JzIHJldHVybmVkIGZyb20gc2VydmVyXG4gIGlmIChyZXN1bHQuc3RhdHVzID09PSB5b3VpRW5naW5lRHJpdmVyUmV0dXJuVmFsdWVzLldFQkRSSVZFUl9VTktOT1dOX0NPTU1BTkQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlVua25vd25Db21tYW5kRXJyb3IoKTtcbiAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdHVzID09PSB5b3VpRW5naW5lRHJpdmVyUmV0dXJuVmFsdWVzLldFQkRSSVZFUl9OT19TVUNIX0VMRU1FTlQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLk5vU3VjaEVsZW1lbnRFcnJvcigpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdC52YWx1ZTtcbn07XG5cbmNvbW1hbmRzLmVsZW1lbnRTZWxlY3RlZCA9IGFzeW5jIGZ1bmN0aW9uIChlbCkge1xuXG4gIGVsID0gdW53cmFwRWwoZWwpO1xuXG4gIHZhciBjb21tYW5kT2JqZWN0ID0ge1xuICAgIG5hbWU6ICdlbGVtZW50U2VsZWN0ZWQnLFxuICAgIGFyZ3M6IFtgJHtlbH1gXVxuICB9O1xuICB2YXIgY29tbWFuZEpTT04gPSBKU09OLnN0cmluZ2lmeShjb21tYW5kT2JqZWN0KTtcblxuICBsZXQgZGF0YSA9IGF3YWl0IHRoaXMuZXhlY3V0ZVNvY2tldENvbW1hbmQoY29tbWFuZEpTT04pO1xuXG4gIGxldCByZXN1bHQ7XG4gIHRyeSB7XG4gICAgcmVzdWx0ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkJhZCByZXNwb25zZSBmcm9tIGVsZW1lbnRTZWxlY3RlZFwiKTtcbiAgfVxuXG4gIC8vIGdldCBzdGF0dXMgcmV0dXJuZWQgYW5kIGhhbmRsZSBlcnJvcnMgcmV0dXJuZWQgZnJvbSBzZXJ2ZXJcbiAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX0VMRU1FTlRfSVNfTk9UX1NFTEVDVEFCTEUpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkVsZW1lbnRJc05vdFNlbGVjdGFibGVFcnJvcigpO1xuICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX05PX1NVQ0hfRUxFTUVOVCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm9TdWNoRWxlbWVudEVycm9yKCk7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0LnZhbHVlO1xufTtcblxuY29tbWFuZHMuZWxlbWVudERpc3BsYXllZCA9IGFzeW5jIGZ1bmN0aW9uIChlbCkge1xuXG4gIGVsID0gdW53cmFwRWwoZWwpO1xuXG4gIHZhciBjb21tYW5kT2JqZWN0ID0ge1xuICAgIG5hbWU6ICdlbGVtZW50RGlzcGxheWVkJyxcbiAgICBhcmdzOiBbYCR7ZWx9YF1cbiAgfTtcbiAgdmFyIGNvbW1hbmRKU09OID0gSlNPTi5zdHJpbmdpZnkoY29tbWFuZE9iamVjdCk7XG5cbiAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmV4ZWN1dGVTb2NrZXRDb21tYW5kKGNvbW1hbmRKU09OKTtcblxuICBsZXQgcmVzdWx0O1xuICB0cnkge1xuICAgIHJlc3VsdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJCYWQgcmVzcG9uc2UgZnJvbSBlbGVtZW50RGlzcGxheWVkXCIpO1xuICB9XG5cbiAgLy8gZ2V0IHN0YXR1cyByZXR1cm5lZCBhbmQgaGFuZGxlIGVycm9ycyByZXR1cm5lZCBmcm9tIHNlcnZlclxuICBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfVU5LTk9XTl9DT01NQU5EKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Vbmtub3duQ29tbWFuZEVycm9yKCk7XG4gIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfTk9fU1VDSF9FTEVNRU5UKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Ob1N1Y2hFbGVtZW50RXJyb3IoKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG59O1xuXG5jb21tYW5kcy5jbGVhciA9IGFzeW5jIGZ1bmN0aW9uIChlbCkge1xuICBlbCA9IHVud3JhcEVsKGVsKTtcblxuICB2YXIgY29tbWFuZE9iamVjdCA9IHtcbiAgICBuYW1lOiAnY2xlYXInLFxuICAgIGFyZ3M6IFtgJHtlbH1gXVxuICB9O1xuXG4gIHZhciBjb21tYW5kSlNPTiA9IEpTT04uc3RyaW5naWZ5KGNvbW1hbmRPYmplY3QpO1xuXG4gIGxldCBkYXRhID0gYXdhaXQgdGhpcy5leGVjdXRlU29ja2V0Q29tbWFuZChjb21tYW5kSlNPTik7XG5cbiAgbGV0IHJlc3VsdDtcbiAgdHJ5IHtcbiAgICByZXN1bHQgPSBKU09OLnBhcnNlKGRhdGEpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQmFkIHJlc3BvbnNlIGZyb20gY2xlYXJcIik7XG4gIH1cblxuICBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfTk9fU1VDSF9FTEVNRU5UKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Ob1N1Y2hFbGVtZW50RXJyb3IoKTtcbiAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdHVzID09PSB5b3VpRW5naW5lRHJpdmVyUmV0dXJuVmFsdWVzLldFQkRSSVZFUl9VTktOT1dOX0NPTU1BTkQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlVua25vd25Db21tYW5kRXJyb3IoKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG59O1xuXG5jb21tYW5kcy5nZXRMb2NhdGlvbiA9IGFzeW5jIGZ1bmN0aW9uIChlbCkge1xuXG4gIGVsID0gdW53cmFwRWwoZWwpO1xuXG4gIHZhciBjb21tYW5kT2JqZWN0ID0ge1xuICAgIG5hbWU6ICdlbGVtZW50TG9jYXRpb24nLFxuICAgIGFyZ3M6IFtgJHtlbH1gXVxuICB9O1xuICB2YXIgY29tbWFuZEpTT04gPSBKU09OLnN0cmluZ2lmeShjb21tYW5kT2JqZWN0KTtcblxuICBsZXQgZGF0YSA9IGF3YWl0IHRoaXMuZXhlY3V0ZVNvY2tldENvbW1hbmQoY29tbWFuZEpTT04pO1xuXG4gIGxldCByZXN1bHQ7XG4gIHRyeSB7XG4gICAgcmVzdWx0ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkJhZCByZXNwb25zZSBmcm9tIGVsZW1lbnRMb2NhdGlvblwiKTtcbiAgfVxuXG4gIC8vIGdldCBzdGF0dXMgcmV0dXJuZWQgYW5kIGhhbmRsZSBlcnJvcnMgcmV0dXJuZWQgZnJvbSBzZXJ2ZXJcbiAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX1VOS05PV05fQ09NTUFORCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkNvbW1hbmRFcnJvcigpO1xuICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX05PX1NVQ0hfRUxFTUVOVCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm9TdWNoRWxlbWVudEVycm9yKCk7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0LnZhbHVlO1xufTtcblxuY29tbWFuZHMuZ2V0TG9jYXRpb25JblZpZXcgPSBhc3luYyBmdW5jdGlvbiAoZWxlbWVudElkKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmdldExvY2F0aW9uKGVsZW1lbnRJZCk7XG59O1xuXG5jb21tYW5kcy5nZXRTaXplID0gYXN5bmMgZnVuY3Rpb24gKGVsKSB7XG5cbiAgZWwgPSB1bndyYXBFbChlbCk7XG5cbiAgdmFyIGNvbW1hbmRPYmplY3QgPSB7XG4gICAgbmFtZTogJ2VsZW1lbnRTaXplJyxcbiAgICBhcmdzOiBbYCR7ZWx9YF1cbiAgfTtcbiAgdmFyIGNvbW1hbmRKU09OID0gSlNPTi5zdHJpbmdpZnkoY29tbWFuZE9iamVjdCk7XG5cbiAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmV4ZWN1dGVTb2NrZXRDb21tYW5kKGNvbW1hbmRKU09OKTtcblxuICBsZXQgcmVzdWx0O1xuICB0cnkge1xuICAgIHJlc3VsdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJCYWQgcmVzcG9uc2UgZnJvbSBnZXRTaXplXCIpO1xuICB9XG5cbiAgLy8gZ2V0IHN0YXR1cyByZXR1cm5lZCBhbmQgaGFuZGxlIGVycm9ycyByZXR1cm5lZCBmcm9tIHNlcnZlclxuICBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfVU5LTk9XTl9DT01NQU5EKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Vbmtub3duQ29tbWFuZEVycm9yKCk7XG4gIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfTk9fU1VDSF9FTEVNRU5UKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Ob1N1Y2hFbGVtZW50RXJyb3IoKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb21tYW5kcztcbiJdLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
